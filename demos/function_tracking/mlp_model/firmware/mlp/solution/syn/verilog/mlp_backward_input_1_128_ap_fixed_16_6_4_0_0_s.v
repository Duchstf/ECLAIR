// ==============================================================
// Generated by Vitis HLS v2024.1
// Copyright 1986-2022 Xilinx, Inc. All Rights Reserved.
// Copyright 2022-2024 Advanced Micro Devices, Inc. All Rights Reserved.
// ==============================================================

`timescale 1 ns / 1 ps 

module mlp_backward_input_1_128_ap_fixed_16_6_4_0_0_s (
        ap_clk,
        ap_rst,
        ap_start,
        ap_done,
        ap_idle,
        ap_ready,
        dL_dy_address0,
        dL_dy_ce0,
        dL_dy_q0,
        mlp_ap_fixed_const_ap_fixed_ap_fixed_const_ap_uint_2_C_C0_x_copy,
        C_C0_z_address0,
        C_C0_z_ce0,
        C_C0_z_q0,
        P_L0_b_address0,
        P_L0_b_ce0,
        P_L0_b_we0,
        P_L0_b_d0,
        P_L0_b_address1,
        P_L0_b_ce1,
        P_L0_b_q1,
        P_L0_W_0_address0,
        P_L0_W_0_ce0,
        P_L0_W_0_we0,
        P_L0_W_0_d0,
        P_L0_W_0_address1,
        P_L0_W_0_ce1,
        P_L0_W_0_we1,
        P_L0_W_0_d1,
        P_L0_W_0_q1
);

parameter    ap_ST_fsm_state1 = 4'd1;
parameter    ap_ST_fsm_pp0_stage0 = 4'd2;
parameter    ap_ST_fsm_pp0_stage1 = 4'd4;
parameter    ap_ST_fsm_state9 = 4'd8;

input   ap_clk;
input   ap_rst;
input   ap_start;
output   ap_done;
output   ap_idle;
output   ap_ready;
output  [6:0] dL_dy_address0;
output   dL_dy_ce0;
input  [15:0] dL_dy_q0;
input  [15:0] mlp_ap_fixed_const_ap_fixed_ap_fixed_const_ap_uint_2_C_C0_x_copy;
output  [6:0] C_C0_z_address0;
output   C_C0_z_ce0;
input  [15:0] C_C0_z_q0;
output  [6:0] P_L0_b_address0;
output   P_L0_b_ce0;
output   P_L0_b_we0;
output  [15:0] P_L0_b_d0;
output  [6:0] P_L0_b_address1;
output   P_L0_b_ce1;
input  [15:0] P_L0_b_q1;
output  [6:0] P_L0_W_0_address0;
output   P_L0_W_0_ce0;
output   P_L0_W_0_we0;
output  [15:0] P_L0_W_0_d0;
output  [6:0] P_L0_W_0_address1;
output   P_L0_W_0_ce1;
output   P_L0_W_0_we1;
output  [15:0] P_L0_W_0_d1;
input  [15:0] P_L0_W_0_q1;

reg ap_done;
reg ap_idle;
reg ap_ready;

(* fsm_encoding = "none" *) reg   [3:0] ap_CS_fsm;
wire    ap_CS_fsm_state1;
wire  signed [31:0] conv7_i_fu_175_p1;
reg  signed [31:0] conv7_i_reg_814;
wire   [0:0] icmp_ln101_fu_187_p2;
reg   [0:0] icmp_ln101_reg_819;
wire    ap_CS_fsm_pp0_stage0;
wire    ap_block_pp0_stage0_11001;
reg   [6:0] P_L0_b_addr_reg_833;
reg   [6:0] P_L0_b_addr_reg_833_pp0_iter1_reg;
reg   [6:0] P_L0_W_0_addr_reg_839;
reg   [6:0] P_L0_W_0_addr_reg_839_pp0_iter1_reg;
reg   [6:0] P_L0_W_0_addr_reg_839_pp0_iter2_reg;
wire   [20:0] add_ln112_fu_360_p2;
reg   [20:0] add_ln112_reg_845;
wire    ap_CS_fsm_pp0_stage1;
wire    ap_block_pp0_stage1_11001;
reg   [0:0] tmp_2822_reg_852;
wire   [8:0] trunc_ln112_fu_374_p1;
reg   [8:0] trunc_ln112_reg_858;
reg  signed [15:0] P_L0_b_load_reg_863;
reg    ap_enable_reg_pp0_iter0;
wire   [0:0] and_ln116_fu_526_p2;
reg   [0:0] and_ln116_reg_868;
wire   [0:0] and_ln116_1_fu_538_p2;
reg   [0:0] and_ln116_1_reg_872;
wire   [0:0] xor_ln116_2_fu_544_p2;
reg   [0:0] xor_ln116_2_reg_876;
reg   [15:0] P_L0_W_0_load_reg_885;
reg    ap_enable_reg_pp0_iter1;
wire   [0:0] and_ln122_4_fu_755_p2;
reg   [0:0] and_ln122_4_reg_895;
wire   [0:0] and_ln122_6_fu_779_p2;
reg   [0:0] and_ln122_6_reg_899;
wire   [0:0] or_ln122_2_fu_785_p2;
reg   [0:0] or_ln122_2_reg_903;
wire    ap_block_pp0_stage0_subdone;
reg    ap_condition_pp0_exit_iter0_state2;
wire    ap_block_pp0_stage1_subdone;
reg    ap_enable_reg_pp0_iter2;
reg    ap_enable_reg_pp0_iter3;
wire   [63:0] zext_ln101_fu_199_p1;
wire    ap_block_pp0_stage0;
reg   [7:0] o_fu_104;
wire   [7:0] add_ln101_fu_193_p2;
reg    C_C0_z_ce0_local;
reg    dL_dy_ce0_local;
reg    P_L0_b_ce1_local;
reg    P_L0_b_we0_local;
reg   [15:0] P_L0_b_d0_local;
wire   [15:0] trunc_ln116_fu_507_p1;
reg    P_L0_b_ce0_local;
reg   [6:0] P_L0_b_address0_local;
wire    ap_block_pp0_stage1;
reg    P_L0_W_0_ce1_local;
reg   [6:0] P_L0_W_0_address1_local;
reg    P_L0_W_0_we1_local;
wire   [15:0] add_ln122_fu_627_p2;
reg    P_L0_W_0_we0_local;
reg   [15:0] P_L0_W_0_d0_local;
reg    P_L0_W_0_ce0_local;
wire   [0:0] icmp_ln15_fu_212_p2;
wire   [25:0] shl_ln_fu_218_p3;
wire   [25:0] select_ln109_fu_226_p3;
wire   [0:0] tmp_2818_fu_260_p3;
wire   [0:0] tmp_2817_fu_252_p3;
wire   [0:0] and_ln109_fu_268_p2;
wire   [15:0] dL_dz_o_fu_242_p4;
wire   [15:0] zext_ln109_fu_274_p1;
wire   [15:0] dL_dz_o_1_fu_278_p2;
wire   [0:0] tmp_fu_234_p3;
wire   [0:0] tmp_2819_fu_284_p3;
wire   [0:0] xor_ln109_fu_292_p2;
wire   [0:0] xor_ln109_1_fu_304_p2;
wire   [0:0] or_ln109_fu_298_p2;
wire   [0:0] xor_ln109_2_fu_310_p2;
wire   [0:0] or_ln109_1_fu_316_p2;
wire   [0:0] and_ln109_1_fu_322_p2;
wire   [15:0] dL_dz_o_2_fu_328_p3;
wire   [18:0] tmp_2820_fu_336_p3;
wire   [16:0] tmp_2821_fu_348_p3;
wire  signed [20:0] sext_ln112_fu_344_p1;
wire  signed [20:0] sext_ln112_1_fu_356_p1;
wire   [10:0] delta_fu_378_p4;
wire   [0:0] tmp_2824_fu_403_p3;
wire   [0:0] icmp_ln112_fu_398_p2;
wire   [0:0] or_ln112_fu_410_p2;
wire   [0:0] tmp_2823_fu_391_p3;
wire   [0:0] and_ln112_fu_416_p2;
wire  signed [11:0] sext_ln112_2_fu_387_p1;
wire   [11:0] zext_ln112_fu_422_p1;
wire   [11:0] delta_3_fu_426_p2;
wire  signed [15:0] sext_ln112_3_fu_432_p1;
wire   [0:0] tmp_2825_fu_436_p3;
wire   [0:0] xor_ln112_fu_444_p2;
wire   [0:0] xor_ln112_1_fu_455_p2;
wire   [0:0] or_ln112_2_fu_449_p2;
wire   [0:0] xor_ln112_2_fu_460_p2;
wire   [0:0] or_ln112_1_fu_466_p2;
wire   [0:0] and_ln112_1_fu_472_p2;
wire  signed [15:0] delta_4_fu_478_p3;
wire  signed [16:0] sext_ln116_fu_486_p1;
wire  signed [16:0] sext_ln116_1_fu_489_p1;
wire   [16:0] sub_ln116_fu_493_p2;
wire   [0:0] tmp_2826_fu_499_p3;
wire   [0:0] tmp_2827_fu_512_p3;
wire   [0:0] xor_ln116_fu_520_p2;
wire   [0:0] xor_ln116_1_fu_532_p2;
wire  signed [25:0] shl_ln1_fu_554_p3;
wire  signed [31:0] grp_fu_791_p3;
wire   [8:0] trunc_ln122_fu_588_p1;
wire   [0:0] tmp_2831_fu_604_p3;
wire   [0:0] icmp_ln122_fu_591_p2;
wire   [0:0] or_ln122_fu_611_p2;
wire   [0:0] tmp_2829_fu_581_p3;
wire   [0:0] and_ln122_fu_617_p2;
wire   [15:0] trunc_ln5_fu_572_p4;
wire   [15:0] zext_ln122_fu_623_p1;
wire   [0:0] tmp_2832_fu_634_p3;
wire   [0:0] tmp_2830_fu_597_p3;
wire   [0:0] xor_ln122_fu_642_p2;
wire   [4:0] tmp_s_fu_661_p4;
wire   [5:0] tmp_2834_fu_676_p4;
wire   [0:0] and_ln122_1_fu_648_p2;
wire   [0:0] icmp_ln122_2_fu_685_p2;
wire   [0:0] icmp_ln122_3_fu_691_p2;
wire   [0:0] tmp_2833_fu_654_p3;
wire   [0:0] icmp_ln122_1_fu_670_p2;
wire   [0:0] xor_ln122_1_fu_705_p2;
wire   [0:0] and_ln122_2_fu_711_p2;
wire   [0:0] and_ln122_3_fu_725_p2;
wire   [0:0] select_ln122_fu_697_p3;
wire   [0:0] xor_ln122_3_fu_737_p2;
wire   [0:0] tmp_2828_fu_565_p3;
wire   [0:0] or_ln122_1_fu_743_p2;
wire   [0:0] xor_ln122_4_fu_749_p2;
wire   [0:0] select_ln122_1_fu_717_p3;
wire   [0:0] and_ln122_5_fu_761_p2;
wire   [0:0] xor_ln122_2_fu_731_p2;
wire   [0:0] empty_fu_773_p2;
wire   [0:0] xor_ln122_5_fu_767_p2;
wire  signed [15:0] grp_fu_791_p1;
wire    ap_CS_fsm_state9;
reg   [3:0] ap_NS_fsm;
reg    ap_ST_fsm_state1_blk;
wire    ap_ST_fsm_state9_blk;
reg    ap_idle_pp0;
wire    ap_enable_pp0;
reg    ap_condition_666;
reg    ap_condition_673;
reg    ap_condition_677;
wire    ap_ce_reg;

// power-on initialization
initial begin
#0 ap_CS_fsm = 4'd1;
#0 ap_enable_reg_pp0_iter0 = 1'b0;
#0 ap_enable_reg_pp0_iter1 = 1'b0;
#0 ap_enable_reg_pp0_iter2 = 1'b0;
#0 ap_enable_reg_pp0_iter3 = 1'b0;
#0 o_fu_104 = 8'd0;
end

mlp_mac_mulsub_16s_16s_26s_32_4_1 #(
    .ID( 1 ),
    .NUM_STAGE( 4 ),
    .din0_WIDTH( 16 ),
    .din1_WIDTH( 16 ),
    .din2_WIDTH( 26 ),
    .dout_WIDTH( 32 ))
mac_mulsub_16s_16s_26s_32_4_1_U403(
    .clk(ap_clk),
    .reset(ap_rst),
    .din0(delta_4_fu_478_p3),
    .din1(grp_fu_791_p1),
    .din2(shl_ln1_fu_554_p3),
    .ce(1'b1),
    .dout(grp_fu_791_p3)
);

always @ (posedge ap_clk) begin
    if (ap_rst == 1'b1) begin
        ap_CS_fsm <= ap_ST_fsm_state1;
    end else begin
        ap_CS_fsm <= ap_NS_fsm;
    end
end

always @ (posedge ap_clk) begin
    if (ap_rst == 1'b1) begin
        ap_enable_reg_pp0_iter0 <= 1'b0;
    end else begin
        if (((1'b0 == ap_block_pp0_stage0_subdone) & (1'b1 == ap_CS_fsm_pp0_stage0) & (1'b1 == ap_condition_pp0_exit_iter0_state2))) begin
            ap_enable_reg_pp0_iter0 <= 1'b0;
        end else if (((ap_start == 1'b1) & (1'b1 == ap_CS_fsm_state1))) begin
            ap_enable_reg_pp0_iter0 <= 1'b1;
        end
    end
end

always @ (posedge ap_clk) begin
    if (ap_rst == 1'b1) begin
        ap_enable_reg_pp0_iter1 <= 1'b0;
    end else begin
        if (((1'b0 == ap_block_pp0_stage1_subdone) & (1'b1 == ap_CS_fsm_pp0_stage1))) begin
            ap_enable_reg_pp0_iter1 <= ap_enable_reg_pp0_iter0;
        end
    end
end

always @ (posedge ap_clk) begin
    if (ap_rst == 1'b1) begin
        ap_enable_reg_pp0_iter2 <= 1'b0;
    end else begin
        if (((1'b0 == ap_block_pp0_stage1_subdone) & (1'b1 == ap_CS_fsm_pp0_stage1))) begin
            ap_enable_reg_pp0_iter2 <= ap_enable_reg_pp0_iter1;
        end
    end
end

always @ (posedge ap_clk) begin
    if (ap_rst == 1'b1) begin
        ap_enable_reg_pp0_iter3 <= 1'b0;
    end else begin
        if ((((1'b0 == ap_block_pp0_stage1_subdone) & (1'b1 == ap_CS_fsm_pp0_stage1)) | ((1'b0 == ap_block_pp0_stage0_subdone) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter2 == 1'b0)))) begin
            ap_enable_reg_pp0_iter3 <= ap_enable_reg_pp0_iter2;
        end else if (((ap_start == 1'b1) & (1'b1 == ap_CS_fsm_state1))) begin
            ap_enable_reg_pp0_iter3 <= 1'b0;
        end
    end
end

always @ (posedge ap_clk) begin
    if (((ap_start == 1'b1) & (1'b1 == ap_CS_fsm_state1))) begin
        o_fu_104 <= 8'd0;
    end else if (((1'b0 == ap_block_pp0_stage0_11001) & (icmp_ln101_fu_187_p2 == 1'd0) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter0 == 1'b1))) begin
        o_fu_104 <= add_ln101_fu_193_p2;
    end
end

always @ (posedge ap_clk) begin
    if (((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0))) begin
        P_L0_W_0_addr_reg_839 <= zext_ln101_fu_199_p1;
        P_L0_W_0_addr_reg_839_pp0_iter1_reg <= P_L0_W_0_addr_reg_839;
        P_L0_W_0_addr_reg_839_pp0_iter2_reg <= P_L0_W_0_addr_reg_839_pp0_iter1_reg;
        P_L0_b_addr_reg_833 <= zext_ln101_fu_199_p1;
        P_L0_b_addr_reg_833_pp0_iter1_reg <= P_L0_b_addr_reg_833;
        and_ln116_1_reg_872 <= and_ln116_1_fu_538_p2;
        and_ln116_reg_868 <= and_ln116_fu_526_p2;
        icmp_ln101_reg_819 <= icmp_ln101_fu_187_p2;
        xor_ln116_2_reg_876 <= xor_ln116_2_fu_544_p2;
    end
end

always @ (posedge ap_clk) begin
    if (((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1) & (ap_enable_reg_pp0_iter1 == 1'b1))) begin
        P_L0_W_0_load_reg_885 <= P_L0_W_0_q1;
    end
end

always @ (posedge ap_clk) begin
    if (((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1) & (ap_enable_reg_pp0_iter0 == 1'b1))) begin
        P_L0_b_load_reg_863 <= P_L0_b_q1;
    end
end

always @ (posedge ap_clk) begin
    if (((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1))) begin
        add_ln112_reg_845[20 : 1] <= add_ln112_fu_360_p2[20 : 1];
        and_ln122_4_reg_895 <= and_ln122_4_fu_755_p2;
        and_ln122_6_reg_899 <= and_ln122_6_fu_779_p2;
        or_ln122_2_reg_903 <= or_ln122_2_fu_785_p2;
        tmp_2822_reg_852 <= add_ln112_fu_360_p2[32'd20];
        trunc_ln112_reg_858[8 : 1] <= trunc_ln112_fu_374_p1[8 : 1];
    end
end

always @ (posedge ap_clk) begin
    if ((1'b1 == ap_CS_fsm_state1)) begin
        conv7_i_reg_814 <= conv7_i_fu_175_p1;
    end
end

always @ (*) begin
    if (((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter0 == 1'b1))) begin
        C_C0_z_ce0_local = 1'b1;
    end else begin
        C_C0_z_ce0_local = 1'b0;
    end
end

always @ (*) begin
    if (((1'b0 == ap_block_pp0_stage1) & (1'b1 == ap_CS_fsm_pp0_stage1) & (ap_enable_reg_pp0_iter2 == 1'b1))) begin
        P_L0_W_0_address1_local = P_L0_W_0_addr_reg_839_pp0_iter2_reg;
    end else if (((1'b0 == ap_block_pp0_stage0) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter1 == 1'b1))) begin
        P_L0_W_0_address1_local = P_L0_W_0_addr_reg_839;
    end else begin
        P_L0_W_0_address1_local = 'bx;
    end
end

always @ (*) begin
    if ((((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (1'd0 == and_ln122_4_reg_895) & (ap_enable_reg_pp0_iter3 == 1'b1) & (1'd1 == and_ln122_6_reg_899) & (or_ln122_2_reg_903 == 1'd1)) | ((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter3 == 1'b1) & (1'd1 == and_ln122_4_reg_895) & (or_ln122_2_reg_903 == 1'd1)))) begin
        P_L0_W_0_ce0_local = 1'b1;
    end else begin
        P_L0_W_0_ce0_local = 1'b0;
    end
end

always @ (*) begin
    if ((((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1) & (ap_enable_reg_pp0_iter2 == 1'b1)) | ((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter1 == 1'b1)))) begin
        P_L0_W_0_ce1_local = 1'b1;
    end else begin
        P_L0_W_0_ce1_local = 1'b0;
    end
end

always @ (*) begin
    if ((1'b1 == ap_condition_666)) begin
        if ((1'd1 == and_ln122_4_reg_895)) begin
            P_L0_W_0_d0_local = 16'd32767;
        end else if (((1'd0 == and_ln122_4_reg_895) & (1'd1 == and_ln122_6_reg_899))) begin
            P_L0_W_0_d0_local = 16'd32768;
        end else begin
            P_L0_W_0_d0_local = 'bx;
        end
    end else begin
        P_L0_W_0_d0_local = 'bx;
    end
end

always @ (*) begin
    if ((((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (1'd0 == and_ln122_4_reg_895) & (ap_enable_reg_pp0_iter3 == 1'b1) & (1'd1 == and_ln122_6_reg_899) & (or_ln122_2_reg_903 == 1'd1)) | ((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter3 == 1'b1) & (1'd1 == and_ln122_4_reg_895) & (or_ln122_2_reg_903 == 1'd1)))) begin
        P_L0_W_0_we0_local = 1'b1;
    end else begin
        P_L0_W_0_we0_local = 1'b0;
    end
end

always @ (*) begin
    if (((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1) & (ap_enable_reg_pp0_iter2 == 1'b1))) begin
        P_L0_W_0_we1_local = 1'b1;
    end else begin
        P_L0_W_0_we1_local = 1'b0;
    end
end

always @ (*) begin
    if ((((1'b0 == ap_block_pp0_stage1) & (1'b1 == ap_CS_fsm_pp0_stage1) & (1'd1 == and_ln116_reg_868) & (ap_enable_reg_pp0_iter1 == 1'b1) & (xor_ln116_2_reg_876 == 1'd1)) | ((1'b0 == ap_block_pp0_stage1) & (1'b1 == ap_CS_fsm_pp0_stage1) & (1'd0 == and_ln116_reg_868) & (1'd1 == and_ln116_1_reg_872) & (ap_enable_reg_pp0_iter1 == 1'b1) & (xor_ln116_2_reg_876 == 1'd1)))) begin
        P_L0_b_address0_local = P_L0_b_addr_reg_833_pp0_iter1_reg;
    end else if (((1'b0 == ap_block_pp0_stage0) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter1 == 1'b1))) begin
        P_L0_b_address0_local = P_L0_b_addr_reg_833;
    end else begin
        P_L0_b_address0_local = 'bx;
    end
end

always @ (*) begin
    if ((((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1) & (1'd1 == and_ln116_reg_868) & (ap_enable_reg_pp0_iter1 == 1'b1) & (xor_ln116_2_reg_876 == 1'd1)) | ((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1) & (1'd0 == and_ln116_reg_868) & (1'd1 == and_ln116_1_reg_872) & (ap_enable_reg_pp0_iter1 == 1'b1) & (xor_ln116_2_reg_876 == 1'd1)) | ((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter1 == 1'b1)))) begin
        P_L0_b_ce0_local = 1'b1;
    end else begin
        P_L0_b_ce0_local = 1'b0;
    end
end

always @ (*) begin
    if (((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter0 == 1'b1))) begin
        P_L0_b_ce1_local = 1'b1;
    end else begin
        P_L0_b_ce1_local = 1'b0;
    end
end

always @ (*) begin
    if ((ap_enable_reg_pp0_iter1 == 1'b1)) begin
        if ((1'b1 == ap_condition_677)) begin
            P_L0_b_d0_local = 16'd32767;
        end else if ((1'b1 == ap_condition_673)) begin
            P_L0_b_d0_local = 16'd32768;
        end else if (((1'b0 == ap_block_pp0_stage0) & (1'b1 == ap_CS_fsm_pp0_stage0))) begin
            P_L0_b_d0_local = trunc_ln116_fu_507_p1;
        end else begin
            P_L0_b_d0_local = 'bx;
        end
    end else begin
        P_L0_b_d0_local = 'bx;
    end
end

always @ (*) begin
    if ((((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1) & (1'd1 == and_ln116_reg_868) & (ap_enable_reg_pp0_iter1 == 1'b1) & (xor_ln116_2_reg_876 == 1'd1)) | ((1'b0 == ap_block_pp0_stage1_11001) & (1'b1 == ap_CS_fsm_pp0_stage1) & (1'd0 == and_ln116_reg_868) & (1'd1 == and_ln116_1_reg_872) & (ap_enable_reg_pp0_iter1 == 1'b1) & (xor_ln116_2_reg_876 == 1'd1)) | ((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter1 == 1'b1)))) begin
        P_L0_b_we0_local = 1'b1;
    end else begin
        P_L0_b_we0_local = 1'b0;
    end
end

always @ (*) begin
    if ((ap_start == 1'b0)) begin
        ap_ST_fsm_state1_blk = 1'b1;
    end else begin
        ap_ST_fsm_state1_blk = 1'b0;
    end
end

assign ap_ST_fsm_state9_blk = 1'b0;

always @ (*) begin
    if ((icmp_ln101_fu_187_p2 == 1'd1)) begin
        ap_condition_pp0_exit_iter0_state2 = 1'b1;
    end else begin
        ap_condition_pp0_exit_iter0_state2 = 1'b0;
    end
end

always @ (*) begin
    if (((1'b1 == ap_CS_fsm_state9) | ((ap_start == 1'b0) & (1'b1 == ap_CS_fsm_state1)))) begin
        ap_done = 1'b1;
    end else begin
        ap_done = 1'b0;
    end
end

always @ (*) begin
    if (((ap_start == 1'b0) & (1'b1 == ap_CS_fsm_state1))) begin
        ap_idle = 1'b1;
    end else begin
        ap_idle = 1'b0;
    end
end

always @ (*) begin
    if (((ap_enable_reg_pp0_iter3 == 1'b0) & (ap_enable_reg_pp0_iter2 == 1'b0) & (ap_enable_reg_pp0_iter1 == 1'b0) & (ap_enable_reg_pp0_iter0 == 1'b0))) begin
        ap_idle_pp0 = 1'b1;
    end else begin
        ap_idle_pp0 = 1'b0;
    end
end

always @ (*) begin
    if ((1'b1 == ap_CS_fsm_state9)) begin
        ap_ready = 1'b1;
    end else begin
        ap_ready = 1'b0;
    end
end

always @ (*) begin
    if (((1'b0 == ap_block_pp0_stage0_11001) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter0 == 1'b1))) begin
        dL_dy_ce0_local = 1'b1;
    end else begin
        dL_dy_ce0_local = 1'b0;
    end
end

always @ (*) begin
    case (ap_CS_fsm)
        ap_ST_fsm_state1 : begin
            if (((ap_start == 1'b1) & (1'b1 == ap_CS_fsm_state1))) begin
                ap_NS_fsm = ap_ST_fsm_pp0_stage0;
            end else begin
                ap_NS_fsm = ap_ST_fsm_state1;
            end
        end
        ap_ST_fsm_pp0_stage0 : begin
            if ((~((1'b0 == ap_block_pp0_stage0_subdone) & (icmp_ln101_fu_187_p2 == 1'd1) & (ap_enable_reg_pp0_iter1 == 1'b0) & (ap_enable_reg_pp0_iter0 == 1'b1)) & ~((1'b0 == ap_block_pp0_stage0_subdone) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter3 == 1'b1) & (ap_enable_reg_pp0_iter2 == 1'b0)) & (1'b0 == ap_block_pp0_stage0_subdone))) begin
                ap_NS_fsm = ap_ST_fsm_pp0_stage1;
            end else if ((((1'b0 == ap_block_pp0_stage0_subdone) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter3 == 1'b1) & (ap_enable_reg_pp0_iter2 == 1'b0)) | ((1'b0 == ap_block_pp0_stage0_subdone) & (icmp_ln101_fu_187_p2 == 1'd1) & (ap_enable_reg_pp0_iter1 == 1'b0) & (ap_enable_reg_pp0_iter0 == 1'b1)))) begin
                ap_NS_fsm = ap_ST_fsm_state9;
            end else begin
                ap_NS_fsm = ap_ST_fsm_pp0_stage0;
            end
        end
        ap_ST_fsm_pp0_stage1 : begin
            if ((1'b0 == ap_block_pp0_stage1_subdone)) begin
                ap_NS_fsm = ap_ST_fsm_pp0_stage0;
            end else begin
                ap_NS_fsm = ap_ST_fsm_pp0_stage1;
            end
        end
        ap_ST_fsm_state9 : begin
            ap_NS_fsm = ap_ST_fsm_state1;
        end
        default : begin
            ap_NS_fsm = 'bx;
        end
    endcase
end

assign C_C0_z_address0 = zext_ln101_fu_199_p1;

assign C_C0_z_ce0 = C_C0_z_ce0_local;

assign P_L0_W_0_address0 = P_L0_W_0_addr_reg_839_pp0_iter2_reg;

assign P_L0_W_0_address1 = P_L0_W_0_address1_local;

assign P_L0_W_0_ce0 = P_L0_W_0_ce0_local;

assign P_L0_W_0_ce1 = P_L0_W_0_ce1_local;

assign P_L0_W_0_d0 = P_L0_W_0_d0_local;

assign P_L0_W_0_d1 = add_ln122_fu_627_p2;

assign P_L0_W_0_we0 = P_L0_W_0_we0_local;

assign P_L0_W_0_we1 = P_L0_W_0_we1_local;

assign P_L0_b_address0 = P_L0_b_address0_local;

assign P_L0_b_address1 = zext_ln101_fu_199_p1;

assign P_L0_b_ce0 = P_L0_b_ce0_local;

assign P_L0_b_ce1 = P_L0_b_ce1_local;

assign P_L0_b_d0 = P_L0_b_d0_local;

assign P_L0_b_we0 = P_L0_b_we0_local;

assign add_ln101_fu_193_p2 = (o_fu_104 + 8'd1);

assign add_ln112_fu_360_p2 = ($signed(sext_ln112_fu_344_p1) + $signed(sext_ln112_1_fu_356_p1));

assign add_ln122_fu_627_p2 = (trunc_ln5_fu_572_p4 + zext_ln122_fu_623_p1);

assign and_ln109_1_fu_322_p2 = (xor_ln109_fu_292_p2 & or_ln109_1_fu_316_p2);

assign and_ln109_fu_268_p2 = (tmp_2818_fu_260_p3 & tmp_2817_fu_252_p3);

assign and_ln112_1_fu_472_p2 = (xor_ln112_fu_444_p2 & or_ln112_1_fu_466_p2);

assign and_ln112_fu_416_p2 = (tmp_2823_fu_391_p3 & or_ln112_fu_410_p2);

assign and_ln116_1_fu_538_p2 = (xor_ln116_1_fu_532_p2 & tmp_2826_fu_499_p3);

assign and_ln116_fu_526_p2 = (xor_ln116_fu_520_p2 & tmp_2827_fu_512_p3);

assign and_ln122_1_fu_648_p2 = (xor_ln122_fu_642_p2 & tmp_2830_fu_597_p3);

assign and_ln122_2_fu_711_p2 = (xor_ln122_1_fu_705_p2 & icmp_ln122_1_fu_670_p2);

assign and_ln122_3_fu_725_p2 = (icmp_ln122_2_fu_685_p2 & and_ln122_1_fu_648_p2);

assign and_ln122_4_fu_755_p2 = (xor_ln122_4_fu_749_p2 & or_ln122_1_fu_743_p2);

assign and_ln122_5_fu_761_p2 = (tmp_2832_fu_634_p3 & select_ln122_1_fu_717_p3);

assign and_ln122_6_fu_779_p2 = (xor_ln122_5_fu_767_p2 & empty_fu_773_p2);

assign and_ln122_fu_617_p2 = (tmp_2829_fu_581_p3 & or_ln122_fu_611_p2);

assign ap_CS_fsm_pp0_stage0 = ap_CS_fsm[32'd1];

assign ap_CS_fsm_pp0_stage1 = ap_CS_fsm[32'd2];

assign ap_CS_fsm_state1 = ap_CS_fsm[32'd0];

assign ap_CS_fsm_state9 = ap_CS_fsm[32'd3];

assign ap_block_pp0_stage0 = ~(1'b1 == 1'b1);

assign ap_block_pp0_stage0_11001 = ~(1'b1 == 1'b1);

assign ap_block_pp0_stage0_subdone = ~(1'b1 == 1'b1);

assign ap_block_pp0_stage1 = ~(1'b1 == 1'b1);

assign ap_block_pp0_stage1_11001 = ~(1'b1 == 1'b1);

assign ap_block_pp0_stage1_subdone = ~(1'b1 == 1'b1);

always @ (*) begin
    ap_condition_666 = ((1'b0 == ap_block_pp0_stage0) & (1'b1 == ap_CS_fsm_pp0_stage0) & (ap_enable_reg_pp0_iter3 == 1'b1) & (or_ln122_2_reg_903 == 1'd1));
end

always @ (*) begin
    ap_condition_673 = ((1'b0 == ap_block_pp0_stage1) & (1'b1 == ap_CS_fsm_pp0_stage1) & (1'd0 == and_ln116_reg_868) & (1'd1 == and_ln116_1_reg_872) & (xor_ln116_2_reg_876 == 1'd1));
end

always @ (*) begin
    ap_condition_677 = ((1'b0 == ap_block_pp0_stage1) & (1'b1 == ap_CS_fsm_pp0_stage1) & (1'd1 == and_ln116_reg_868) & (xor_ln116_2_reg_876 == 1'd1));
end

assign ap_enable_pp0 = (ap_idle_pp0 ^ 1'b1);

assign conv7_i_fu_175_p1 = $signed(mlp_ap_fixed_const_ap_fixed_ap_fixed_const_ap_uint_2_C_C0_x_copy);

assign dL_dy_address0 = zext_ln101_fu_199_p1;

assign dL_dy_ce0 = dL_dy_ce0_local;

assign dL_dz_o_1_fu_278_p2 = (dL_dz_o_fu_242_p4 + zext_ln109_fu_274_p1);

assign dL_dz_o_2_fu_328_p3 = ((and_ln109_1_fu_322_p2[0:0] == 1'b1) ? 16'd32767 : dL_dz_o_1_fu_278_p2);

assign dL_dz_o_fu_242_p4 = {{select_ln109_fu_226_p3[25:10]}};

assign delta_3_fu_426_p2 = ($signed(sext_ln112_2_fu_387_p1) + $signed(zext_ln112_fu_422_p1));

assign delta_4_fu_478_p3 = ((and_ln112_1_fu_472_p2[0:0] == 1'b1) ? 16'd32767 : sext_ln112_3_fu_432_p1);

assign delta_fu_378_p4 = {{add_ln112_reg_845[20:10]}};

assign empty_fu_773_p2 = (xor_ln122_2_fu_731_p2 & tmp_2828_fu_565_p3);

assign grp_fu_791_p1 = conv7_i_reg_814;

assign icmp_ln101_fu_187_p2 = ((o_fu_104 == 8'd128) ? 1'b1 : 1'b0);

assign icmp_ln112_fu_398_p2 = ((trunc_ln112_reg_858 != 9'd0) ? 1'b1 : 1'b0);

assign icmp_ln122_1_fu_670_p2 = ((tmp_s_fu_661_p4 == 5'd31) ? 1'b1 : 1'b0);

assign icmp_ln122_2_fu_685_p2 = ((tmp_2834_fu_676_p4 == 6'd63) ? 1'b1 : 1'b0);

assign icmp_ln122_3_fu_691_p2 = ((tmp_2834_fu_676_p4 == 6'd0) ? 1'b1 : 1'b0);

assign icmp_ln122_fu_591_p2 = ((trunc_ln122_fu_588_p1 != 9'd0) ? 1'b1 : 1'b0);

assign icmp_ln15_fu_212_p2 = (($signed(C_C0_z_q0) > $signed(16'd0)) ? 1'b1 : 1'b0);

assign or_ln109_1_fu_316_p2 = (xor_ln109_2_fu_310_p2 | tmp_2819_fu_284_p3);

assign or_ln109_fu_298_p2 = (xor_ln109_fu_292_p2 | tmp_2819_fu_284_p3);

assign or_ln112_1_fu_466_p2 = (xor_ln112_2_fu_460_p2 | tmp_2825_fu_436_p3);

assign or_ln112_2_fu_449_p2 = (xor_ln112_fu_444_p2 | tmp_2825_fu_436_p3);

assign or_ln112_fu_410_p2 = (tmp_2824_fu_403_p3 | icmp_ln112_fu_398_p2);

assign or_ln122_1_fu_743_p2 = (xor_ln122_3_fu_737_p2 | tmp_2832_fu_634_p3);

assign or_ln122_2_fu_785_p2 = (and_ln122_6_fu_779_p2 | and_ln122_4_fu_755_p2);

assign or_ln122_fu_611_p2 = (tmp_2831_fu_604_p3 | icmp_ln122_fu_591_p2);

assign select_ln109_fu_226_p3 = ((icmp_ln15_fu_212_p2[0:0] == 1'b1) ? shl_ln_fu_218_p3 : 26'd0);

assign select_ln122_1_fu_717_p3 = ((and_ln122_1_fu_648_p2[0:0] == 1'b1) ? and_ln122_2_fu_711_p2 : icmp_ln122_2_fu_685_p2);

assign select_ln122_fu_697_p3 = ((and_ln122_1_fu_648_p2[0:0] == 1'b1) ? icmp_ln122_2_fu_685_p2 : icmp_ln122_3_fu_691_p2);

assign sext_ln112_1_fu_356_p1 = $signed(tmp_2821_fu_348_p3);

assign sext_ln112_2_fu_387_p1 = $signed(delta_fu_378_p4);

assign sext_ln112_3_fu_432_p1 = $signed(delta_3_fu_426_p2);

assign sext_ln112_fu_344_p1 = $signed(tmp_2820_fu_336_p3);

assign sext_ln116_1_fu_489_p1 = delta_4_fu_478_p3;

assign sext_ln116_fu_486_p1 = P_L0_b_load_reg_863;

assign shl_ln1_fu_554_p3 = {{P_L0_W_0_load_reg_885}, {10'd0}};

assign shl_ln_fu_218_p3 = {{dL_dy_q0}, {10'd0}};

assign sub_ln116_fu_493_p2 = ($signed(sext_ln116_fu_486_p1) - $signed(sext_ln116_1_fu_489_p1));

assign tmp_2817_fu_252_p3 = select_ln109_fu_226_p3[32'd9];

assign tmp_2818_fu_260_p3 = select_ln109_fu_226_p3[32'd10];

assign tmp_2819_fu_284_p3 = dL_dz_o_1_fu_278_p2[32'd15];

assign tmp_2820_fu_336_p3 = {{dL_dz_o_2_fu_328_p3}, {3'd0}};

assign tmp_2821_fu_348_p3 = {{dL_dz_o_2_fu_328_p3}, {1'd0}};

assign tmp_2823_fu_391_p3 = add_ln112_reg_845[32'd9];

assign tmp_2824_fu_403_p3 = add_ln112_reg_845[32'd10];

assign tmp_2825_fu_436_p3 = sext_ln112_3_fu_432_p1[32'd15];

assign tmp_2826_fu_499_p3 = sub_ln116_fu_493_p2[32'd16];

assign tmp_2827_fu_512_p3 = sub_ln116_fu_493_p2[32'd15];

assign tmp_2828_fu_565_p3 = grp_fu_791_p3[32'd31];

assign tmp_2829_fu_581_p3 = grp_fu_791_p3[32'd9];

assign tmp_2830_fu_597_p3 = grp_fu_791_p3[32'd25];

assign tmp_2831_fu_604_p3 = grp_fu_791_p3[32'd10];

assign tmp_2832_fu_634_p3 = add_ln122_fu_627_p2[32'd15];

assign tmp_2833_fu_654_p3 = grp_fu_791_p3[32'd26];

assign tmp_2834_fu_676_p4 = {{grp_fu_791_p3[31:26]}};

assign tmp_fu_234_p3 = select_ln109_fu_226_p3[32'd25];

assign tmp_s_fu_661_p4 = {{grp_fu_791_p3[31:27]}};

assign trunc_ln112_fu_374_p1 = add_ln112_fu_360_p2[8:0];

assign trunc_ln116_fu_507_p1 = sub_ln116_fu_493_p2[15:0];

assign trunc_ln122_fu_588_p1 = grp_fu_791_p3[8:0];

assign trunc_ln5_fu_572_p4 = {{grp_fu_791_p3[25:10]}};

assign xor_ln109_1_fu_304_p2 = (tmp_fu_234_p3 ^ 1'd1);

assign xor_ln109_2_fu_310_p2 = (xor_ln109_1_fu_304_p2 ^ or_ln109_fu_298_p2);

assign xor_ln109_fu_292_p2 = (tmp_fu_234_p3 ^ 1'd1);

assign xor_ln112_1_fu_455_p2 = (tmp_2822_reg_852 ^ 1'd1);

assign xor_ln112_2_fu_460_p2 = (xor_ln112_1_fu_455_p2 ^ or_ln112_2_fu_449_p2);

assign xor_ln112_fu_444_p2 = (tmp_2822_reg_852 ^ 1'd1);

assign xor_ln116_1_fu_532_p2 = (tmp_2827_fu_512_p3 ^ 1'd1);

assign xor_ln116_2_fu_544_p2 = (tmp_2827_fu_512_p3 ^ tmp_2826_fu_499_p3);

assign xor_ln116_fu_520_p2 = (tmp_2826_fu_499_p3 ^ 1'd1);

assign xor_ln122_1_fu_705_p2 = (tmp_2833_fu_654_p3 ^ 1'd1);

assign xor_ln122_2_fu_731_p2 = (1'd1 ^ and_ln122_3_fu_725_p2);

assign xor_ln122_3_fu_737_p2 = (select_ln122_fu_697_p3 ^ 1'd1);

assign xor_ln122_4_fu_749_p2 = (tmp_2828_fu_565_p3 ^ 1'd1);

assign xor_ln122_5_fu_767_p2 = (1'd1 ^ and_ln122_5_fu_761_p2);

assign xor_ln122_fu_642_p2 = (tmp_2832_fu_634_p3 ^ 1'd1);

assign zext_ln101_fu_199_p1 = o_fu_104;

assign zext_ln109_fu_274_p1 = and_ln109_fu_268_p2;

assign zext_ln112_fu_422_p1 = and_ln112_fu_416_p2;

assign zext_ln122_fu_623_p1 = and_ln122_fu_617_p2;

always @ (posedge ap_clk) begin
    add_ln112_reg_845[0] <= 1'b0;
    trunc_ln112_reg_858[0] <= 1'b0;
end

endmodule //mlp_backward_input_1_128_ap_fixed_16_6_4_0_0_s
